# 3D график для точки минимальных выплат

## Загрузка данных

Загрузка файла с БД по опционам. Формат файла SQLite.


```python
!curl -o rts_nn.db -L 'https://drive.google.com/uc?export=download&confirm=yes&id=1ML9AKyQexvic_ut2aMstI_7DQ2b6vHrv'  # Закачка файла БД
```

      % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                     Dload  Upload   Total   Spent    Left  Speed
      0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
    100  840k  100  840k    0     0  2164k      0 --:--:-- --:--:-- --:--:--  164M
    

Загрузка данных из БД в DF.


```python
# %matplotlib
# %matplotlib notebook
%matplotlib inline
# matplotlib.use('nbagg')

import pandas as pd
from typing import Any
import numpy as np
import sqlite3
import matplotlib.pyplot as plt


connection = sqlite3.connect('rts_nn.db', check_same_thread=True)  # Создание соединения с БД
with connection:
  df_all = pd.read_sql('SELECT * FROM `All_opt`', connection)  # Загрузка данных из БД

print(df_all.to_string(max_rows=6, max_cols=25))  # Проверка того, что загрузилось
```

           TRADEDATE    -22500    -20000    -17500    -15000    -12500    -10000     -7500     -5000     -2500    0      2500      5000      7500     10000     12500     15000     17500     20000  22500  zero_strike   close     low    high
    0     2015-01-05  0.728363  0.605605  0.600028  0.456538  0.454987  0.258267  0.345876  0.183768  0.262591  0.0  0.284517  0.170603  0.359587  0.260492  0.504470  0.458944  0.909248  0.768367    1.0        72500  2100.0   -30.0  6480.0
    1     2015-01-06  0.676081  0.560392  0.555003  0.416899  0.415333  0.229272  0.311330  0.161136  0.233857  0.0  0.289971  0.189553  0.379894  0.285059  0.530621  0.484260  0.916784  0.780905    1.0        72500   980.0 -1300.0  2110.0
    2     2015-01-08  0.548794  0.450866  0.446081  0.330494  0.329217  0.181043  0.258321  0.138457  0.202241  0.0  0.265168  0.160529  0.330973  0.258061  0.506760  0.469379  0.870850  0.757173    1.0        72500  7480.0 -1500.0  8880.0
    ...          ...       ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...       ...       ...    ...          ...     ...     ...     ...
    1985  2022-12-28  0.848746  0.828423  0.817585  0.711167  0.663799  0.582576  0.533955  0.304759  0.111452  0.0  0.135529  0.092753  0.345610  0.537144  0.722648  0.773471  0.870407  0.906975    1.0        97500 -1300.0 -1330.0  1870.0
    1986  2022-12-29  0.724340  0.717070  0.678723  0.663194  0.470939  0.457866  0.381184  0.356907  0.148621  0.0  0.009194  0.283218  0.153112  0.413203  0.641912  0.838733  0.861018  0.954080    1.0        95000  1640.0   600.0  3180.0
    1987  2022-12-30  0.733349  0.708816  0.686451  0.508133  0.486602  0.425623  0.390517  0.182369  0.057725  0.0  0.114708  0.096801  0.301505  0.486329  0.680449  0.759743  0.826896  0.877805    1.0        97500   730.0 -1280.0  1760.0
    

## Построение 2d графика


```python
df = df_all.set_index('TRADEDATE').sort_index(ascending=True)  # TRADEDATE в индекс
print(df.to_string(max_rows=6, max_cols=25))  # Проверка того, что получилось
```

                  -22500    -20000    -17500    -15000    -12500    -10000     -7500     -5000     -2500    0      2500      5000      7500     10000     12500     15000     17500     20000  22500  zero_strike   close     low    high
    TRADEDATE                                                                                                                                                                                                                            
    2015-01-05  0.728363  0.605605  0.600028  0.456538  0.454987  0.258267  0.345876  0.183768  0.262591  0.0  0.284517  0.170603  0.359587  0.260492  0.504470  0.458944  0.909248  0.768367    1.0        72500  2100.0   -30.0  6480.0
    2015-01-06  0.676081  0.560392  0.555003  0.416899  0.415333  0.229272  0.311330  0.161136  0.233857  0.0  0.289971  0.189553  0.379894  0.285059  0.530621  0.484260  0.916784  0.780905    1.0        72500   980.0 -1300.0  2110.0
    2015-01-08  0.548794  0.450866  0.446081  0.330494  0.329217  0.181043  0.258321  0.138457  0.202241  0.0  0.265168  0.160529  0.330973  0.258061  0.506760  0.469379  0.870850  0.757173    1.0        72500  7480.0 -1500.0  8880.0
    ...              ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...       ...       ...    ...          ...     ...     ...     ...
    2022-12-28  0.848746  0.828423  0.817585  0.711167  0.663799  0.582576  0.533955  0.304759  0.111452  0.0  0.135529  0.092753  0.345610  0.537144  0.722648  0.773471  0.870407  0.906975    1.0        97500 -1300.0 -1330.0  1870.0
    2022-12-29  0.724340  0.717070  0.678723  0.663194  0.470939  0.457866  0.381184  0.356907  0.148621  0.0  0.009194  0.283218  0.153112  0.413203  0.641912  0.838733  0.861018  0.954080    1.0        95000  1640.0   600.0  3180.0
    2022-12-30  0.733349  0.708816  0.686451  0.508133  0.486602  0.425623  0.390517  0.182369  0.057725  0.0  0.114708  0.096801  0.301505  0.486329  0.680449  0.759743  0.826896  0.877805    1.0        97500   730.0 -1280.0  1760.0
    


```python
plt.figure(figsize=(25,8))

plt.axhline(y=0, color='red', linestyle='--')
plt.axhline(y=2500, color='red', linestyle='--')
plt.axhline(y=-2500, color='red', linestyle='--')

df["close"].plot()
plt.show()
```


    
![png](3D%20%D1%82%D0%BE%D1%87%D0%BA%D0%B0%20%D0%BC%D0%B8%D0%BD%D0%B8%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85%20%D0%B2%D1%8B%D0%BF%D0%BB%D0%B0%D1%82_files/3D%20%D1%82%D0%BE%D1%87%D0%BA%D0%B0%20%D0%BC%D0%B8%D0%BD%D0%B8%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85%20%D0%B2%D1%8B%D0%BF%D0%BB%D0%B0%D1%82_8_0.png)
    


## Построение 3D графика


```python
from matplotlib.figure import projections


ax = plt.axes(projection='3d')
x_data = df_all[1:20]

```


    
![png](3D%20%D1%82%D0%BE%D1%87%D0%BA%D0%B0%20%D0%BC%D0%B8%D0%BD%D0%B8%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85%20%D0%B2%D1%8B%D0%BF%D0%BB%D0%B0%D1%82_files/3D%20%D1%82%D0%BE%D1%87%D0%BA%D0%B0%20%D0%BC%D0%B8%D0%BD%D0%B8%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D1%8B%D1%85%20%D0%B2%D1%8B%D0%BF%D0%BB%D0%B0%D1%82_10_0.png)
    

